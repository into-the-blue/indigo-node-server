import Path from 'path';
import 'reflect-metadata';
require('dotenv').config({
  path: Path.join(__dirname, '..', '.env'),
});
require('module-alias/register');
import { handleConditions } from '../src/apiv1/subscription/model/helper';

const conditions:any = [
  {
    type: 'range',
    key: 'price',
    condition: [-1, 4000],
    value: [1500, 8000],
  },
  {
    type: 'boolean',
    key: 'type',
    condition: true,
    value: ['合租', '整租'],
  },
  {
    type: 'boolean',
    key: 'isApartment',
    condition: false,
    value: ['否', '是'],
  },
  {
    type: 'range',
    key: 'area',
    condition: [20, -1],
    value: [10, 100],
  },
];
const apt:any = {
    id: '5f06223496c1c444b7c9b647',
    type: '整租',
    title: '整租·汉中小区 1室1厅 南',
    createdAt: '2020-07-06',
    houseCode: 'SH2559696702076624896',
    houseId: '2559696702076624896',
    cityAbbreviation: 'sh',
    imgUrls: [
      'https://ke-image.ljcdn.com/rent-user-avatar/83da512f-c9a2-453a-b033-8f9b698c9428.780x439.jpg',
      'https://ke-image.ljcdn.com/rent-user-avatar/3f03b4a6-9166-4636-8f7d-2359c0555f1f.780x439.jpg',
      'https://ke-image.ljcdn.com/rent-user-avatar/f9f4a97e-a262-4ad4-b660-fcc725eeaadc.780x439.jpg',
      'https://ke-image.ljcdn.com/rent-user-avatar/3bd3632d-da46-440e-a3e2-1b5ae7421439.780x439.jpg',
      'https://ke-image.ljcdn.com/rent-user-avatar/8e4bfcb9-a15a-4bc0-bac9-40193c5c7295.780x439.jpg',
      'https://ke-image.ljcdn.com/rent-user-avatar/de930768-31be-44a5-922a-5b20e7846986.780x439.jpg',
    ],
    price: 2890,
    tags: ['新上', '公寓', '月租', '精装', '随时看房'],
    houseType: '1室1厅1卫',
    area: 21,
    orient: '南',
    floorFullInfo: '3/7层',
    floor: '3',
    buildingTotalFloors: 7,
    lease: '6~12个月',
    carport: '暂无数据',
    electricity: '民电',
    checkInDate: '随时入住',
    elevator: '无',
    water: '民水',
    gas: '有',
    heating: 0,
    floorAccessibility: 1,
    television: 0,
    fridge: 1,
    washingMachine: 1,
    airCondition: 1,
    waterHeater: 1,
    bed: 1,
    wifi: 1,
    closet: 1,
    naturalGas: 0,
    transportations: [],
    subwayAccessibility: 0,
    communityDeals: '',
    houseDescription:
      '~找个好房子，把生活过成想要的样子；<br />\n~从”住”开始，对自己好一点；<br />\n~睡得更好一点，自由更多一点，生活更方便一点；<br />\n~全新精装修，独立卫浴，配置床、衣柜、床头柜、电视柜、挂壁式液晶电视、空调，拎包入住。',
    houseUrl: 'https://sh.zu.ke.com/zufang/SH2559696702076624896.html',
    city: '上海',
    district: '静安',
    bizcircle: '不夜城',
    communityName: '汉中小区',
    communityUrl: 'https://sh.zu.ke.com/zufang/c5011000017330/',
    pricePerSquareMeter: 137.62,
    missingInfo: false,
    missingKeys: [],
    version: '2020-07-08',
    createdTime: '2020-07-09T03:40:00.558Z',
    updatedTime: '2020-07-09T03:44:52.249Z',
    lng: 121.45994,
    lat: 31.243199,
    geoInfo: {
      status: '1',
      info: 'OK',
      infocode: '10000',
      count: '1',
      geocodes: [
        {
          formattedAddress: '上海市静安区汉中小区',
          country: '中国',
          province: '上海市',
          citycode: '021',
          city: '上海市',
          district: '静安区',
          township: [],
          neighborhood: {
            name: [],
            type: [],
          },
          building: {
            name: [],
            type: [],
          },
          adcode: '310106',
          street: [],
          number: [],
          location: '121.459940,31.243199',
          level: '兴趣点',
        },
      ],
    },
    coordtype: 'amap-gcj02',
    coordinates: [121.45994, 31.243199],
    forcePass: true,
    notified: 1,
    notificationSent: true,
    computed: {
      updatedAt: '2020-07-08T19:44:53.426Z',
      averagePrice: 10551.88,
      averagePPSM: 148.49,
      averageArea: 65.49,
      medianPPSM: 131.59,
      medianPrice: 5400,
      medianArea: 42,
      rankingOfPPSM: 468,
      rankingOfPrice: 53,
      rankingOfArea: 75,
      lowestPPSM: '5ee6aa970b8b0377c110f2ab',
      lowestPrice: '5edc56c521b23aa0b65945e0',
      total: 824,
      range: 500,
    },
    updatedAt: '2020-07-08T19:44:53.426Z',
  }
console.warn(handleConditions(conditions, apt));
