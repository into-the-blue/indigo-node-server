version: '3'
services:
  node-server:
    build: .
    container_name: indigo-node-server
    image: indigo-node
    volumes:
      - ./logs:/apps/node-server/logs
    ports:
      - '7000:7000'
    restart: always
    env_file:
      - ./prod.env
    working_dir: /apps/node-server
    command: ['npm', 'run', 'start']
    
    networks:
      internal:

  redis:
    image: 'redis:latest'
    sysctls:
      - vm.overcommit_memory=1
      - net.core.somaxconn=511
    networks:
      internal:

networks: 
  internal: 
